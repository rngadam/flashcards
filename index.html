<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcards</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="top-bar">
      <h1 id="config-title"></h1>
      <span id="detected-lang"></span>
      <div>
        <button id="history-button">üìú</button>
        <button id="settings-button">‚öôÔ∏è</button>
      </div>
    </div>

    <div id="history-modal" class="hidden">
      <div id="history-panel">
        <button id="close-history-button">X</button>
        <h2>History</h2>
        <div id="history-table-container"></div>
      </div>
    </div>

    <div id="settings-modal" class="hidden">
      <div id="settings">
        <button id="close-settings-button">X</button>
        <h2>Settings</h2>

        <div class="setting">
            <label for="config-name">Configuration Name:</label>
            <input type="text" id="config-name" placeholder="e.g., Spanish Vocabulary">
        </div>

        <div class="setting">
          <label for="config-selector">Load Configuration:</label>
          <select id="config-selector"></select>
        </div>

        <div class="setting data-source-setting">
          <label for="data-url">Data Source URL (TSV/CSV):</label>
          <div class="input-with-button">
            <input type="text" id="data-url" value="https://docs.google.com/spreadsheets/d/e/2PACX-1vSW_KeHCyth3-9kWtpYHXl9aPVwoOhurjGINbJ4oNHWGoQMjSHyZl0J9LeraGDt51ZUjIsqrv9DXO27/pub?gid=2060234086&single=true&output=tsv">
            <button id="load-data">Load</button>
          </div>
        </div>

        <div class="setting">
          <label for="key-column-selector">Unique Key Column:</label>
          <select id="key-column-selector"></select>
        </div>

        <div class="tabs" role="tablist">
          <button class="tab-button active" id="basic-tab" data-tab="basic-settings" role="tab" aria-controls="basic-settings" aria-selected="true">Basic</button>
          <button class="tab-button" id="advanced-tab" data-tab="advanced-settings" role="tab" aria-controls="advanced-settings" aria-selected="false">Advanced</button>
          <button class="tab-button" id="subset-tab" data-tab="subset-settings" role="tab" aria-controls="subset-settings" aria-selected="false">Subset</button>
          <button class="tab-button" id="dangerous-tab" data-tab="dangerous-settings" role="tab" aria-controls="dangerous-settings" aria-selected="false">Dangerous</button>
        </div>

        <div id="basic-settings" class="tab-panel active" role="tabpanel" aria-labelledby="basic-tab">
            <div class="setting">
                <label>Front Column(s):</label>
                <div id="front-column-checkboxes" class="column-checkbox-group"></div>
            </div>
            <div class="setting">
                <label>Back Column(s):</label>
                <div id="back-column-checkboxes" class="column-checkbox-group"></div>
            </div>
            <div class="setting">
                <label>Practice Skills:</label>
                <div id="skill-selector-checkboxes" class="column-checkbox-group"></div>
            </div>
            <div class="setting">
                <label for="font-selector">Font:</label>
                <select id="font-selector">
                    <option value="Arial">Arial</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Courier New">Courier New</option>
                </select>
            </div>
            <div class="setting">
                <input type="checkbox" id="tts-front">
                <label for="tts-front">Text-to-Speech on Front</label>
                <select id="tts-front-lang"></select>
            </div>
            <div class="setting">
                <input type="checkbox" id="tts-back">
                <label for="tts-back">Text-to-Speech on Back</label>
                <select id="tts-back-lang"></select>
            </div>
        </div>

        <div id="advanced-settings" class="tab-panel" role="tabpanel" aria-labelledby="advanced-tab">
            <div class="setting">
                <label for="tts-rate">Reading Speed:</label>
                <input type="range" id="tts-rate" min="0.1" max="2" value="1" step="0.1">
            </div>
            <div class="setting">
                <input type="checkbox" id="alternate-uppercase">
                <label for="alternate-uppercase">Alternate Uppercase on Front</label>
            </div>
            <div class="setting">
                <input type="checkbox" id="disable-animation">
                <label for="disable-animation">Disable Flip Animation</label>
            </div>
            <div class="setting">
                <input type="checkbox" id="audio-only-front">
                <label for="audio-only-front">Audio-Only Front</label>
            </div>
            <div class="setting">
                <input type="checkbox" id="tts-on-hotkey-only">
                <label for="tts-on-hotkey-only">Only read on hotkey (f)</label>
            </div>
            <div class="setting">
                <label for="repetition-intervals">Repetition Intervals (seconds, comma-separated):</label>
                <textarea id="repetition-intervals" rows="3"></textarea>
            </div>
        </div>

        <div id="subset-settings" class="tab-panel" role="tabpanel" aria-labelledby="subset-tab">
            <div class="setting">
                <label for="subset-config-name">New Subset Name:</label>
                <input type="text" id="subset-config-name" placeholder="e.g., Chapter 1 Words">
            </div>
            <div class="setting">
                <label for="subset-text">Source Text:</label>
                <textarea id="subset-text" rows="5" placeholder="Paste text here..."></textarea>
            </div>
            <button id="create-subset-config">Create and Load Subset</button>
        </div>

        <div id="dangerous-settings" class="tab-panel" role="tabpanel" aria-labelledby="dangerous-tab">
            <div class="setting">
                <p>This action cannot be undone.</p>
                <button id="reset-stats" class="danger">Reset Current Deck Stats</button>
            </div>
        </div>

        <div class="button-container">
            <button id="save-config" disabled>Save Configuration</button>
        </div>
      </div>
    </div>

    <div id="card-container">
      <div id="card">
        <div class="card-face card-front"></div>
        <div class="card-face card-back"></div>
      </div>
    </div>

    <div id="controls">
      <button id="prev-card"><span>‚¨ÖÔ∏è</span><span class="btn-text"> Prev (&larr;)</span></button>
      <button id="i-dont-know"><span>‚ùå</span><span class="btn-text"> I don't know (j)</span></button>
      <button id="flip-card"><span>üîÑ</span><span class="btn-text"> Flip (Space)</span></button>
      <button id="i-know"><span>‚úÖ</span><span class="btn-text"> I know this (k)</span></button>
      <button id="next-card"><span>‚û°Ô∏è</span><span class="btn-text"> Next (&rarr;)</span></button>
      <span class="hotkey-hint">Slow Replay (f)</span>
    </div>

    <div id="card-stats">
        <span id="card-specific-stats"></span>
        <div id="cache-status"></div>
    </div>

    <div id="skill-mastery-dashboard"></div>

    <div id="explanation-message"></div>
    <script type="module" src="app.js"></script>
  </body>
</html>
